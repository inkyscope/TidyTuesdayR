---
title: "MeteoritesImpacts"
author: "Sung Inkyung"
date: '2020 3 21 '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(ggthemes)
library(here)
```


```{r}
meteorites <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-11/meteorites.csv")

```


```{r}
meteorites %>%
  count(mass, sort = T) %>% 
  arrange(-mass)
 
top_10 <- meteorites %>% 
  top_n(10, mass) %>% 
  arrange(-mass)

small_mass <-  meteorites %>% 
  filter(mass < 16000000)


```
### Source[NASA Color Codes] (https://nasa.github.io/nasawds-site/components/colors/) 
### Source[tidytuesday by ch-bu] (https://github.com/ch-bu/tidytuesday/blob/master/2019-06-12/meteorites.R)

```{r}
world <- ggplot() +
  borders("world", color = "#5b616b", fill = "#5b616b") +
  coord_map(projection = "mollweid", 
            orientation = c(90, 0, 0)) +
  geom_point(data = top_10, 
             na.rm = T,
             color = "#99231b",
             aes(long, lat, size = mass),
             alpha = 1) +
  geom_text(data = top_10,
             aes(x = long, y = lat,
                label = name), 
            color = "white",
             size = 3,
            hjust = 1,
            vjust = 1) +
  geom_point(data = small_mass, 
             na.rm = T,
             color = "#e59892",
             aes(long, lat, size = mass),
             alpha = .1) +
  labs(title = "Meteorites Impacts on Earth",
       subtitle = "Red dot represents top 10 meteorites impacts with a mass bigger than 16tons.\nHoba is the biggest meteorite ever found on earth. It weighs 60tons and found in 1920.",
       caption = "Source: NASA | Graphic: Sung Inkyung") +
  theme_map() +
  theme(legend.position = "none",
        plot.background = element_rect(fill = "#061f4a"),
        panel.background = element_rect(fill = "#061f4a",
                                        color = "#061f4a"),
        plot.title = element_text(size = 18,
                                  face = "bold",
                                  hjust = .5,
                                  color = "#a6e5d8",
                                  margin = margin(b = 13)),
        plot.subtitle = element_text(size = 15,
                                     hjust = .5,
                                     color = "#a6e5d8",
                                     margin = margin(b = 20)),
        plot.caption = element_text(size = 9,
                                    color = "#e1f3f8",
                                    margin = margin(t = 10)),
        plot.margin = unit(c(1, 1, 1, 1), "cm"))

ggsave(here("figures", "MeteoritesImpacts.png"), width = 9, height = 7)

  
```

